#ifndef __MACRO_DEF__
#define __MACRO_DEF__

// Handle cuTENSOR errors
#define HANDLE_ERROR(x)                                             \
{ const auto err = x;                                               \
    if( err != CUTENSOR_STATUS_SUCCESS )                              \
    { printf("Error: %s\n", cutensorGetErrorString(err)); exit(-1); } \
};

#define HANDLE_CUDA_ERROR(x)                                      \
{ const auto err = x;                                             \
    if( err != cudaSuccess )                                        \
    { printf("Error: %s\n", cudaGetErrorString(err)); exit(-1); } \
};


#define MAX_SEQUENCE_LENGTH 500
#define _32bit_t int32_t
#define IS_EPSILON(SYMBOL_ID) ((SYMBOL_ID) == 0xFFFF)
#define IS_TERMINATE(SYMBOL_ID) ((SYMBOL_ID) >= N)
#define IS_NONTERMINATE(SYMBOL_ID) ((SYMBOL_ID) < N)

#define ALPHA_INCREASE(SYMBOL, I, J, VALUE) alpha[(SYMBOL) * MS * MS + (I) * MS + J] +=  VALUE;
#define BETA_INCREASE(SYMBOL, I, J, VALUE) beta[(SYMBOL) * MS * MS + (I) * MS + J] +=  VALUE;
#define MU_INCREASE(SYMBOL, I, J, VALUE) mu[(SYMBOL) * MS * MS + (I) * MS + J] +=  VALUE;

#define ALPHA(SYMBOL, I, J) alpha[(SYMBOL) * MS * MS + (I) * MS + J]
#define BETA(SYMBOL, I, J) beta[(SYMBOL) * MS * MS + (I) * MS + J]
#define MU(GID, I, J) mu[(GID) * MS * MS + (I) * MS + J]

#define SYMBOL_STR(GRAMMAR, SYMBOL_ID, N) ((SYMBOL_ID) < N ? (GRAMMAR)->reversed_nonterminate_map[(SYMBOL_ID)]: (GRAMMAR)->reversed_terminate_map[(SYMBOL_ID) - N])

#endif
